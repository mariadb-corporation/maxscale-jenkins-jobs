shell: |
  echo "Checking $GIT_BRANCH"
  branches_list=`cat $branches_list_file`
  for $line in $branches_list
  do
    branch_pattern=`cat $line | sed -e 's/|[^|]*$//g'`
    test_set=`cat $line | sed -e 's/^[^|]*|//g'`
    if [ cat $GIT_BRANCH | grep -q $branch_pattern ] 
    then
      echo "$GIT_BRANCH matches $branch_pattern!"
      echo "test_set=$test_set" > $WORKSPACE/env_vars_$BUILD_ID
      touch branch_match
      exit 0
    fi
  done
  echo "$GIT_BRANCH does not match any patterns from $branches_list_file!"
