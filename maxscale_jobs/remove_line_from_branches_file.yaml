- job:
    name: remove_line_from_branches_file
    description: 'This job remove a first line with branch from given file.'
    parameters:
      - string:
          name: branch
      - choice:
          name: file
          choices:
            - $HOME/run_test_branches.list
            - $HOME/on_push_maxscale_branches.list
      - !include: './maxscale_jobs/include/repo.yaml'
    builders:
      - shell: |
          LINE_NUMBER=$(grep -n --max-count=1 "$branch|" $file | cut -f1 -d:)
          if [ -z $LINE_NUMBER ]; then
            echo "$branch not exist!"
            exit 1
          fi
          echo "$branch exist"
          $(sed -i $LINE_NUMBER"d" $file)
          echo "$branch remove success"
